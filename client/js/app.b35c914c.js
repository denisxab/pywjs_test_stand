(function(){"use strict";var e={5651:function(e,t,s){var n=s(9242),o=s(3396);const i={class:"app"},r={class:"test_box"};function c(e,t,s,n,c,a){const d=(0,o.up)("PyjsLog"),_=(0,o.up)("testUseServer");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(d),(0,o._)("div",i,[(0,o._)("div",r,[(0,o.Wm)(_,{get_h_id:c.test_send.get_h_id,label:"Тестовый стенд PywJs",template:c.test_send.template,type_send:c.test_send.type_send,token:c.token,host:c.host,port:c.port,onSend:a.send,onSend_force:a.send_force,onSend_dependent:a.send_dependent,onSend_transaction:a.send_transaction,onSend_before:a.send_before},null,8,["get_h_id","template","type_send","token","host","port","onSend","onSend_force","onSend_dependent","onSend_transaction","onSend_before"])])])],64)}var a=s(7139);const d=e=>((0,o.dD)("data-v-2bc94a64"),e=e(),(0,o.Cn)(),e),_={class:"label"},l={class:"use_server"},u={class:"request"},h={class:"vselect"},p=d((()=>(0,o._)("span",{class:"help"},"ctrl+enter Отправить сообщение",-1))),b={class:"response"},m={class:"infohid"};function f(e,t,s,n,i,r){const c=(0,o.up)("vtextarea"),d=(0,o.up)("vselect"),f=(0,o.up)("vbutton"),v=(0,o.up)("PrettyJson");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("h2",_,(0,a.zw)(s.label),1),(0,o._)("div",l,[(0,o._)("div",u,[(0,o.Wm)(c,{background:"#3b4252",color:"#eceff4",modelValue:i.request,"onUpdate:modelValue":t[0]||(t[0]=e=>i.request=e)},null,8,["modelValue"]),(0,o._)("div",h,[(0,o.Wm)(d,{color:"#d8dee9",modelValue:i.selectTemplate,"onUpdate:modelValue":t[1]||(t[1]=e=>i.selectTemplate=e),options:s.template,type_select:"dict",label:"Шаблоны",onChange:r.SelectChangeTemplate},null,8,["modelValue","options","onChange"]),(0,o.Wm)(d,{color:"#d8dee9",type_select:"list",modelValue:i.selectSend,"onUpdate:modelValue":t[2]||(t[2]=e=>i.selectSend=e),options:s.type_send,label:"Варианты отправки сообщения"},null,8,["modelValue","options"])]),(0,o.Wm)(f,{class:"vbutton",onClick:r.ClickSend},{default:(0,o.w5)((()=>[(0,o.Uk)("Отправить")])),_:1},8,["onClick"]),p]),(0,o._)("div",b,[(0,o.Wm)(v,{JsonPretty:r.Response},null,8,["JsonPretty"]),(0,o._)("div",m,"Ожидает h_id: "+(0,a.zw)(s.get_h_id),1)])])],64)}const v=e=>((0,o.dD)("data-v-48e37caa"),e=e(),(0,o.Cn)(),e),w={class:"vselect_box"},y=["v-model"],g=v((()=>(0,o._)("option",{disabled:"",value:""},"Выбор из списка",-1))),k=["value"],C=["value"];function S(e,t,s,n,i,r){return(0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("label",null,(0,a.zw)(s.label),1),(0,o._)("select",{"v-model":s.modelValue,onChange:t[0]||(t[0]=(...e)=>r.changeOption&&r.changeOption(...e))},[g,"dict"==s.type_select?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(s.options,((e,t,s)=>((0,o.wg)(),(0,o.iD)("option",{key:t,value:t},(0,a.zw)(t),9,k)))),128)):"list"==s.type_select?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(s.options,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e,value:e},(0,a.zw)(e),9,C)))),128)):(0,o.kq)("",!0)],40,y)])}const D={props:{label:{type:String,default:()=>"Название"},type_select:String,options:{type:Object},modelValue:{type:String},background:{type:String,default:()=>"#000"},color:{type:String,default:()=>"#000"}},methods:{changeOption(e){this.$emit("update:modelValue",e.target.value)}},mounted(){if("dict"==this.type_select){const e=Object.keys(this.options)[0];this.$emit("update:modelValue",e),this.$emit("change")}else if("list"==this.type_select){const e=this.options[0];this.$emit("update:modelValue",e),this.$emit("change")}}},I=()=>{(0,n.sj)((e=>({bd8ae662:e.color,"783b097c":e.background})))},O=D.setup;D.setup=O?(e,t)=>(I(),O(e,t)):I;var j=D,H=s(89);const U=(0,H.Z)(j,[["render",S],["__scopeId","data-v-48e37caa"]]);var $=U;const L=["value","placeholder"];function J(e,t,s,n,i,r){return(0,o.wg)(),(0,o.iD)("textarea",{value:s.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),placeholder:s.placeholder,style:(0,a.j5)(r.cssProps)},null,44,L)}var N={props:{modelValue:String,placeholder:{type:String,default:()=>"...."},background:{type:String,default:()=>"#000"},color:{type:String,default:()=>"#000"}},computed:{cssProps(){return{"--Фон":this.background,"--color":this.color}}}};const T=(0,H.Z)(N,[["render",J],["__scopeId","data-v-dc3b4d44"]]);var x=T;const V={class:"prettyJson"},W={ref:"json"};function Z(e,t,s,n,i,r){return(0,o.wg)(),(0,o.iD)("div",V,[(0,o._)("div",W,null,512)])}const E=function(){var e=function(){this._dom={},this._dom.container=document.createElement("pre"),this._dom.container.classList.add("json-viewer")};return e.prototype.showJSON=function(e,t,s){t="number"===typeof t?t:-1,s="number"===typeof s?s:-1;var n=this._processInput(e),o=this._walk(n,t,s,0);this._dom.container.innerHTML="",this._dom.container.appendChild(o)},e.prototype.getContainer=function(){return this._dom.container},e.prototype._processInput=function(e){if(e&&"object"===typeof e)return e;throw"Input value is not object or array!"},e.prototype._walk=function(e,t,s,n){var o=document.createDocumentFragment(),i=t>=0&&n>=t,r=s>=0&&n>=s;switch(typeof e){case"object":if(e){var c=Array.isArray(e),a=c?e:Object.keys(e);if(0===n){var d=this._createItemsCount(a.length),_=this._createLink(c?"[":"{");a.length?(_.addEventListener("click",function(){i||(_.classList.toggle("collapsed"),d.classList.toggle("hide"),this._dom.container.querySelector("ul").classList.toggle("hide"))}.bind(this)),r&&(_.classList.add("collapsed"),d.classList.remove("hide"))):_.classList.add("empty"),_.appendChild(d),o.appendChild(_)}if(a.length&&!i){var l=a.length-1,u=document.createElement("ul");u.setAttribute("data-level",n),u.classList.add("type-"+(c?"array":"object")),a.forEach((function(o,i){var r=c?o:e[o],a=document.createElement("li");if("object"===typeof r){if(!r||r instanceof Date)a.appendChild(document.createTextNode(c?"":o+": ")),a.appendChild(this._createSimple(r||null));else{var d=Array.isArray(r),_=d?r.length:Object.keys(r).length;if(_){var h=("string"===typeof o?o+": ":"")+(d?"[":"{"),p=this._createLink(h),b=this._createItemsCount(_);t>=0&&n+1>=t?a.appendChild(document.createTextNode(h)):(p.appendChild(b),a.appendChild(p)),a.appendChild(this._walk(r,t,s,n+1)),a.appendChild(document.createTextNode(d?"]":"}"));var m=a.querySelector("ul"),f=function(){p.classList.toggle("collapsed"),b.classList.toggle("hide"),m.classList.toggle("hide")};p.addEventListener("click",f),s>=0&&n+1>=s&&f()}else a.appendChild(document.createTextNode(o+": "+(d?"[]":"{}")))}}else c||a.appendChild(document.createTextNode(o+": ")),a.appendChild(this._walk(r,t,s,n+1));i<l&&a.appendChild(document.createTextNode(",")),u.appendChild(a)}),this),o.appendChild(u)}else if(a.length&&i){var h=this._createItemsCount(a.length);h.classList.remove("hide"),o.appendChild(h)}if(0===n){if(!a.length){h=this._createItemsCount(0);h.classList.remove("hide"),o.appendChild(h)}o.appendChild(document.createTextNode(c?"]":"}")),r&&o.querySelector("ul").classList.add("hide")}break}default:o.appendChild(this._createSimple(e));break}return o},e.prototype._createSimple=function(e){var t=document.createElement("span"),s=typeof e,n=e;return"string"===s?n='"'+e+'"':null===e?(s="null",n="null"):void 0===e?n="undefined":e instanceof Date&&(s="date",n=e.toString()),t.classList.add("type-"+s),t.innerHTML=n,t},e.prototype._createItemsCount=function(e){var t=document.createElement("span");return t.classList.add("items-ph"),t.classList.add("hide"),t.innerHTML=this._getItemsTitle(e),t},e.prototype._createLink=function(e){var t=document.createElement("a");return t.classList.add("list-link"),t.href="javascript:void(0)",t.innerHTML=e||"",t},e.prototype._getItemsTitle=function(e){var t=e>1||0===e?"items":"item";return e+" "+t},e}();var P={data(){return{jsonViewer:new E}},props:{JsonPretty:Object},watch:{JsonPretty:{handler(e){this.jsonViewer.showJSON(e)},deep:!0}},mounted(){this.$refs.json.appendChild(this.jsonViewer.getContainer()),this.jsonViewer.showJSON(this.JsonPretty)}};const A=(0,H.Z)(P,[["render",Z]]);var q=A;function F(e,t,s,n,i,r){return(0,o.wg)(),(0,o.iD)("button",null,[(0,o.WI)(e.$slots,"default",{},void 0,!0)])}var M={data(){return{}},methods:{}};const R=(0,H.Z)(M,[["render",F],["__scopeId","data-v-a778464a"]]);var Y=R,z={emits:["send","send_force","send_dependent","send_transaction","send_before"],components:{Vbutton:Y,Vtextarea:x,Vselect:$,PrettyJson:q},props:{get_h_id:Number,label:String,template:Object,type_send:Object,token:String,host:String,port:String},data(){return{request:"",selectTemplate:"",selectSend:""}},methods:{ClickSend(){this.$emit(this.selectSend,this.request)},SelectChangeTemplate(){this.request=this.template[this.selectTemplate]}},computed:{Response(){const e=this.$store.state.wbs.res.value[this.get_h_id];return e||{}}},mounted(){this._keyListener=function(e){"Enter"==e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.ClickSend())},document.addEventListener("keydown",this._keyListener.bind(this))},beforeDestroy(){document.removeEventListener("keydown",this._keyListener)}};const G=(0,H.Z)(z,[["render",f],["__scopeId","data-v-2bc94a64"]]);var K=G;const X=["value"],B={class:"log"},Q={class:"log__use"},ee={class:"h_id_s"},te=["h_id","value"],se={class:"log__info"},ne={class:"url_connect"},oe={class:"wbsStatus"};function ie(e,t,s,i,r,c){const d=(0,o.up)("PrettyJson");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",{onClick:t[0]||(t[0]=(...e)=>c.hiddenWindow&&c.hiddenWindow(...e)),class:"log__status"},[(0,o._)("div",{class:(0,a.C_)(["status_code",{connect:1==c.wbsStatusCode,wait_connect:2==c.wbsStatusCode,error_connect:3==c.wbsStatusCode}])},null,2),(0,o._)("input",{type:"button",value:c.isHideShow},null,8,X)]),(0,o.wy)((0,o._)("div",B,[(0,o._)("div",Q,[(0,o._)("div",ee,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(c.ArrayH_ID,(e=>((0,o.wg)(),(0,o.iD)("input",{class:(0,a.C_)(["h_id",{update:e[1].is_update,select:e[1].is_select}]),type:"button",h_id:e[0],key:e[0],value:e[1].alias,onClick:t[1]||(t[1]=(...e)=>c.clickHID&&c.clickHID(...e))},null,10,te)))),128))])]),(0,o._)("div",se,[(0,o._)("div",ne,[(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.UrlFromNewConnect=e),placeholder:"ws://host:port/  |  Подключиться на новый URL ?"},null,512),[[n.nr,r.UrlFromNewConnect]]),(0,o._)("input",{type:"button",value:"Переподключиться",onClick:t[3]||(t[3]=(...e)=>c.ConnectNewUrl&&c.ConnectNewUrl(...e))})]),(0,o._)("div",oe,(0,a.zw)(c.wbsStatus),1),(0,o.Wm)(d,{JsonPretty:r.textViewH_ID},null,8,["JsonPretty"])])],512),[[n.F8,1==r.isShow]])],64)}var re,ce,ae,de,_e;(function(e){e[e["normal"]=1e3]="normal",e[e["lose_clients"]=1001]="lose_clients",e[e["big_response"]=1009]="big_response",e[e["server_error"]=1011]="server_error",e[e["server_reload"]=1012]="server_reload",e[e["server_again"]=1013]="server_again",e[e["tls_error"]=1015]="tls_error",e[e["authentication_error"]=4001]="authentication_error",e[e["disconnect_then_reconnect_new_url"]=4002]="disconnect_then_reconnect_new_url"})(re||(re={})),function(e){e[e["info"]=1]="info",e[e["func"]=2]="func",e[e["exec"]=3]="exec",e[e["import_from_server"]=4]="import_from_server",e[e["event_create"]=5]="event_create",e[e["event_sub"]=6]="event_sub",e[e["event_unsub"]=7]="event_unsub",e[e["cache_add_key"]=8]="cache_add_key",e[e["cache_read_key"]=9]="cache_read_key"}(ce||(ce={})),function(e){e[e["transaction_func"]=101]="transaction_func"}(ae||(ae={})),function(e){e[e["help_allowed"]=1]="help_allowed",e[e["check_token"]=2]="check_token",e[e["info_event"]=3]="info_event"}(de||(de={})),function(e){e[e["error_parse_request_clients"]=100]="error_parse_request_clients",e[e["error_server"]=101]="error_server",e[e["token_error"]=102]="token_error",e[e["ok"]=200]="ok",e[e["notify"]=201]="notify",e[e["rollback_from_clients"]=401]="rollback_from_clients",e[e["rollback_from_server"]=402]="rollback_from_server"}(_e||(_e={}));var le=s(2482);s(7658);const ue=ce,he=ae,pe=_e;var be,me,fe;(function(e){e[e["connect"]=1]="connect",e[e["wait_connect"]=2]="wait_connect",e[e["error_connect"]=3]="error_connect"})(be||(be={})),function(e){e[e["duplicate_uid"]=1]="duplicate_uid",e[e["timeout_notify"]=2]="timeout_notify",e[e["timeout_response"]=3]="timeout_response",e[e["error_server"]=4]="error_server"}(me||(me={})),function(e){e[e["create"]=0]="create",e[e["get_notify"]=1]="get_notify",e[e["get_response"]=2]="get_response",e[e["rollback"]=3]="rollback"}(fe||(fe={}));const ve=2e3;class we{constructor(e,{host:t="localhost",port:s=9999,callback_onopen:n=(e=>{}),callback_onmessage:o=(e=>{}),callback_onclose:i=(e=>{}),callback_onerror:r=(e=>{}),event_connect:c=(()=>{}),event_error_connect:a=(()=>{}),callback_update_status:d=((e,t)=>{}),user:_="base"}={}){(0,le.Z)(this,"force_set",void 0),(0,le.Z)(this,"transaction_dict",void 0),(0,le.Z)(this,"before_map",void 0),(0,le.Z)(this,"token",void 0),(0,le.Z)(this,"w_status",void 0),(0,le.Z)(this,"user",void 0),(0,le.Z)(this,"_wbs_connect",void 0),(0,le.Z)(this,"_wbs_url",void 0),(0,le.Z)(this,"_dependent_list",void 0),(0,le.Z)(this,"_is_reconnected",!1),(0,le.Z)(this,"_idInterval_smart_connect",void 0),(0,le.Z)(this,"callback_update_status",void 0),(0,le.Z)(this,"_generator_uid_c",void 0),this.force_set=new Set,this.transaction_dict={},this.token=e,this.w_status=0,this.user=_,this.before_map=new Map,this._generator_uid_c=0,this.callback_update_status=d,this._dependent_list=[],this._wbs_url=`ws://${t}:${s}/`;let l=new WebSocket(this._wbs_url);l.onopen=e=>{clearInterval(this._idInterval_smart_connect),this._update_status(be.connect,`Успешное подключение к ${this._wbs_connect.url}`),this._send_token(),c&&c(),void 0!==n&&n(e)},l.onmessage=e=>{let t=JSON.parse(e.data);t.t_exec=this._GetCurrentTime()-t.t_send;const s=t.uid_c;this.force_set.has(s)&&(this.force_set.delete(s),this.before_map.has(s)&&(this.before_map.get(s)(t),this.before_map.delete(s))),this.transaction_dict[s]&&(t=this._check_transaction(s,t)),void 0!==o&&o(t)},l.onerror=e=>{void 0!==r&&r(e)},l.onclose=e=>{this._is_reconnected=!0,console.warn(`${e.code}:${e.reason}`),i&&i(e),this._smart_connect(l,c,a)},this._wbs_connect=l,this._smart_connect(l,c,a)}send({mod:e,h_id:t,uid_c:s,body:n}){if(void 0===s&&(s=this.getUidC()),void 0!==this._wbs_connect&&this.w_status==be.connect){switch(e){case ce.cache_add_key:case ce.cache_read_key:n.user||(n.user=this.user);break}this._wbs_connect.send(JSON.stringify({h_id:t,uid_c:s,mod:e,body:n,t_send:this._GetCurrentTime()}))}else console.error(`Сообщение "mod=${e}" не отправленное так как нет соединения`)}send_force({mod:e,h_id:t,uid_c:s,body:n},o=ve){if(void 0===s&&(s=this.getUidC()),!this.force_set.has(s)){this.force_set.add(s),this.send({mod:e,h_id:t,uid_c:s,body:n});const i=setInterval((()=>{this.w_status==be.connect&&void 0!==this._wbs_connect&&this.force_set.has(s)?this.send({mod:e,h_id:t,uid_c:s,body:n}):clearInterval(i)}),o)}}send_dependent({mod:e,h_id:t,uid_c:s,body:n},o=ve){void 0===s&&(s=this.getUidC());const i={mod:e,uid_c:s,d:{h_id:t,body:n},ms:o};this._dependent_list.push(i),this.send_force({mod:i.mod,h_id:i.d.h_id,uid_c:i.uid_c,body:i.d.body},i.ms)}send_transaction({mod:e,h_id:t,uid_c:s,body:n},o,i=ve,r=5e3){if(e!=ue.func)throw new Error("Передача в режиме транзакции поддерживается только для модификации:(func_trans)");const c=he.transaction_func;void 0===s&&(s=this.getUidC()),this.transaction_dict[s]?o(me.duplicate_uid,t,s,void 0):(this.transaction_dict[s]={status:fe.create,timeoutID_notify:setTimeout((()=>{clearTimeout(this.transaction_dict[s].timeoutID_response),this.transaction_dict[s].status=fe.rollback,o(me.timeout_notify,t,s,void 0)}),i),timeoutID_response:setTimeout((()=>{this.transaction_dict[s].status=fe.rollback,o(me.timeout_response,t,s,void 0)}),r),rollback_because_error:e=>{this.transaction_dict[s].status=fe.rollback,o(me.error_server,t,s,e)}},this.send({mod:c,h_id:t,uid_c:s,body:n}))}send_before({mod:e,h_id:t,body:s,after:n}){const o=this.getUidC();this.before_map.set(o,n),this.send_force({mod:e,h_id:t,body:s,uid_c:o})}_send_token(){this.send({mod:ce.info,h_id:-1,uid_c:0,body:{id_r:de.check_token,text:this.token}})}_again_send_dependent(){for(const e of this._dependent_list)this.send_force({mod:e.mod,h_id:e.d.h_id,uid_c:e.uid_c,body:e.d.body},e.ms)}_update_status(e,t){console.info(t),this.w_status=e,void 0!==this.callback_update_status&&this.callback_update_status(e,t)}close(e,t){this._wbs_connect.close(e,t)}getUidC(){return this._GeneratorUidC()}connectNewUrl(e){this._wbs_url=e,this.close(re.disconnect_then_reconnect_new_url,`NewUrl:${e}`)}_smart_connect(e,t,s,n=1e3){this._idInterval_smart_connect=setInterval((()=>{this._update_status(be.wait_connect,`Попытка подключится к ${this._wbs_connect.url} > ${this._wbs_connect.readyState}`),this._wbs_connect.readyState===be.error_connect?(this._update_status(be.error_connect,`Не удалось подключиться к ${this._wbs_connect.url} ${ye()}`),s&&s(),this._wbs_connect=new WebSocket(this._wbs_url)):this._wbs_connect.readyState===be.connect&&(this._update_status(be.connect,`Успешное подключение к ${this._wbs_connect.url}`),this._wbs_connect.onopen=e.onopen,this._wbs_connect.onmessage=e.onmessage,this._wbs_connect.onerror=e.onerror,this._wbs_connect.onclose=e.onclose,this._is_reconnected&&this._send_token(),t&&t(),this._is_reconnected&&this._again_send_dependent(),clearInterval(this._idInterval_smart_connect))}),n)}_GeneratorUidC(){return this._generator_uid_c=(this._generator_uid_c+1)%Number.MAX_SAFE_INTEGER,this._generator_uid_c}_GetCurrentTime(){return(new Date).getTime()/1e3}_check_transaction(e,t){const s=this.transaction_dict[e].status;switch(s){case fe.create:t.code==pe.notify&&(clearTimeout(this.transaction_dict[e].timeoutID_notify),this.transaction_dict[e].status=fe.get_notify);break;case fe.get_notify:t.code==pe.ok?(clearTimeout(this.transaction_dict[e].timeoutID_response),this.transaction_dict[e].status=fe.get_response,delete this.transaction_dict[e]):[pe.error_server,pe.error_parse_request_clients].includes(t.code)?(clearTimeout(this.transaction_dict[e].timeoutID_response),t.code=pe.rollback_from_server,this.transaction_dict[e].rollback_because_error(t.error),delete this.transaction_dict[e]):alert("Не поддерживаемый статус ответа на транзакцию");break;case fe.rollback:{const e="Произошел `rollback` транзакции, по причине клиента";t.code=pe.rollback_from_clients,t.error=e,console.error(e);break}default:console.log("Ошибка статуса транзакции")}return t}}function ye(){const e=new Date;return e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()+" @ "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}class ge{constructor(e){(0,le.Z)(this,"names",{}),(0,le.Z)(this,"ids",{});for(const t in e)this.names[t]=e[t],this.ids[e[t]]=t}}const ke=re;var Ce={components:{PrettyJson:q},props:{hids:{type:ge,default:void 0}},data(){return{isShow:!1,AllJson:{},DictH_ID_CheckUid_C:{},textViewH_ID:{},viewH_ID:0,lastH_ID:void 0,UrlFromNewConnect:""}},computed:{isHideShow(){return this.isShow?"Виден":"Скрыт"},wbsStatusCode(){return this.$store.state.wbs.wbsStatusCode},wbsStatus(){return this.$store.state.wbs.wbsStatus},ArrayH_ID(){if(this.isShow){this.AllJson=this.$store.state.wbs.res.value;for(const e in this.AllJson){const t=this.AllJson[e].uid_c;if(this.DictH_ID_CheckUid_C[e])this.DictH_ID_CheckUid_C[e].uid_c!=t&&(this.DictH_ID_CheckUid_C[e].uid_c=t,this.DictH_ID_CheckUid_C[e].is_update=!0,this.viewH_ID==e&&(this.textViewH_ID=this.AllJson[e]));else{const s=this.hids?this.hids.ids[e]:void 0;this.DictH_ID_CheckUid_C[e]={uid_c:t,is_update:!0,alias:s||e}}}return Object.entries(this.DictH_ID_CheckUid_C).sort(((e,t)=>e[1].alias>t[1].alias))}return{}}},methods:{disconnect(){this.$store.state.wbs.wbsObj.close(ke.normal,"Разрыв связи из логера")},hiddenWindow(){this.isShow=!this.isShow},clickHID(e){const t=e.target;if(t){this.lastH_ID&&(this.DictH_ID_CheckUid_C[this.lastH_ID].is_select=!1);const e=t.attributes["h_id"].value;this.viewH_ID=e,this.DictH_ID_CheckUid_C[e].is_update=!1,this.DictH_ID_CheckUid_C[e].is_select=!0,this.textViewH_ID=this.AllJson[e],this.lastH_ID=e}},ConnectNewUrl(){this.$store.state.wbs.wbsObj.connectNewUrl(this.UrlFromNewConnect)}}};const Se=(0,H.Z)(Ce,[["render",ie],["__scopeId","data-v-2786824e"]]);var De=Se;function Ie(e){return JSON.stringify(e,null,4)}const Oe=89,je="sysdba",He="localhost",Ue="9999";var $e={components:{PyjsLog:De,TestUseServer:K},data(){return{token:je,host:He,port:Ue,test_send:{get_h_id:Oe,type_send:["send","send_force","send_dependent","send_transaction","send_before"],template:{exec:Ie({mod:ce.exec,h_id:Oe,body:{exec:"2+2"}}),import_from_server:Ie({mod:ce.import_from_server,h_id:Oe,body:{import_sts_exe:"import os"}}),func:Ie({mod:ce.func,h_id:Oe,body:{n_func:"os_exe_async",args:["ifconfig"],kwargs:{}}}),"func:transaction":Ie({mod:ce.func,h_id:Oe,body:{n_func:"readFile",args:["/media/denis/dd19b13d-bd85-46bb-8db9-5b8f6cf7a825/Dowload/tes/","test.txt"],kwargs:{}}}),"info:help_allowed":Ie({mod:ce.info,h_id:Oe,body:{id_r:de.help_allowed}}),"info:info_event":Ie({mod:ce.info,h_id:Oe,body:{id_r:de.info_event}}),event_create:Ie({mod:ce.event_create,h_id:Oe,body:{n_func:"watchDir",mod:"_",args:["/media/denis/dd19b13d-bd85-46bb-8db9-5b8f6cf7a825/Dowload/"],kwargs:{}}}),event_sub:Ie({mod:ce.event_sub,h_id:Oe,body:{n_func:"watchDir",mod:"_"}}),event_unsub:Ie({mod:ce.event_unsub,h_id:Oe,body:{n_func:"watchDir",mod:"_"}}),cache_add_key:Ie({mod:ce.cache_add_key,h_id:Oe,body:{key:"current_date",value:JSON.stringify({date:Date.now()}),user:"base"}}),cache_read_key:Ie({mod:ce.cache_read_key,h_id:Oe,body:{key:"current_date",user:"base"}}),send_before:Ie({mod:ce.cache_read_key,h_id:Oe,body:{key:"current_date",user:"base"}})}}}},methods:{send(e){const t=JSON.parse(e);console.log("send"),console.log(t),this.$store.dispatch("wbs/send",t)},send_force(e){const t=JSON.parse(e);console.log("send_force"),console.log(t),this.$store.dispatch("wbs/send_force",t)},send_dependent(e){const t=JSON.parse(e);console.log("send_dependent"),console.log(t),this.$store.dispatch("wbs/send_dependent",t)},send_transaction(e){const t=JSON.parse(e);console.log("send_transaction"),t["rollback"]=(e,t,s)=>{alert(`Rollback:[error_code=${e}|h_id=${t}|uid_c=${s}]\nНе получилось прочитать файл.`)},console.log(t),this.$store.dispatch("wbs/send_transaction",t)},send_before(e){const t=JSON.parse(e);t["after"]=e=>{alert(`Прошлый запрос ${JSON.stringify(e,null,2)}`)},console.log("send_before"),console.log(t),this.$store.dispatch("wbs/send_before",t)}},beforeCreate(){this.$store.dispatch("wbs/initWebSocket",{token:je,host:He,port:Ue})}};const Le=(0,H.Z)($e,[["render",c]]);var Je=Le,Ne=s(65);const Te={state(){return{wbsObj:Object,wbsStatus:"",wbsStatusCode:be.wait_connect,res:{value:{}}}},getters:{},mutations:{_updateWbsObj(e,t){e.wbsObj=t},_updateWbsStatus(e,t){e.wbsStatus=t},_updateWbsStatusCode(e,t){e.wbsStatusCode=t},_updateResponse(e,t){e.res.value[t.h_id]=t,console.log(t)}},actions:{send({state:e},{mod:t,h_id:s,body:n}){e.wbsObj.send({mod:t,h_id:s,body:n})},send_force({state:e},{mod:t,h_id:s,body:n}){e.wbsObj.send_force({mod:t,h_id:s,body:n})},send_dependent({state:e},{mod:t,h_id:s,body:n}){e.wbsObj.send_dependent({mod:t,h_id:s,body:n})},send_transaction({state:e},{mod:t,h_id:s,body:n,rollback:o}){e.wbsObj.send_transaction({mod:t,h_id:s,body:n},o)},send_before({state:e},{mod:t,h_id:s,body:n,after:o}){e.wbsObj.send_before({mod:t,h_id:s,body:n,after:o})},initWebSocket({commit:e,dispatch:t},{host:s="localhost",port:n=9999,token:o="",user:i="base",after_connect:r=(()=>{}),destruction:c=(()=>{})}){e("_updateWbsObj",new we(o,{host:s,port:n,callback_onopen:()=>{r()},callback_onmessage:e=>{t("_handleResponseFormServer",e)},callback_onclose:()=>{},callback_onerror:e=>{},event_connect:()=>{},event_error_connect:()=>{},callback_update_status:(e,s)=>{t("_onUpdateStatus",{status_code:e,status_text:s})},user:i})),window.addEventListener("beforeunload",(e=>(c(),console.log("Вызван destruction"),e.preventDefault(),e.returnValue="Да?")))},_handleResponseFormServer({commit:e},t){try{""!=t.response&&(t.response=JSON.parse(t.response)),e("_updateResponse",t)}catch(s){console.error("Не удалось конвертировать в Json: state.responseRaw.value"),console.error(t)}},_onUpdateStatus({commit:e},{status_code:t=0,status_text:s=""}={}){e("_updateWbsStatusCode",t),e("_updateWbsStatus",s)}},namespaced:!0};var xe=(0,Ne.MT)({modules:{wbs:Te}});const Ve=(0,n.ri)(Je);Ve.use(xe).mount("#app")}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,i){if(!n){var r=1/0;for(_=0;_<e.length;_++){n=e[_][0],o=e[_][1],i=e[_][2];for(var c=!0,a=0;a<n.length;a++)(!1&i||r>=i)&&Object.keys(s.O).every((function(e){return s.O[e](n[a])}))?n.splice(a--,1):(c=!1,i<r&&(r=i));if(c){e.splice(_--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var _=e.length;_>0&&e[_-1][2]>i;_--)e[_]=e[_-1];e[_]=[n,o,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,r=n[0],c=n[1],a=n[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(o in c)s.o(c,o)&&(s.m[o]=c[o]);if(a)var _=a(s)}for(t&&t(n);d<r.length;d++)i=r[d],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(_)},n=self["webpackChunkpywjs_test_stand"]=self["webpackChunkpywjs_test_stand"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[998],(function(){return s(5651)}));n=s.O(n)})();
//# sourceMappingURL=app.b35c914c.js.map